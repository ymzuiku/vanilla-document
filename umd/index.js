!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).vanilly={})}(this,function(e){"use strict";var t;[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach(function(e){e.hasOwnProperty("remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})}),[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach(function(e){e.hasOwnProperty("append")||Object.defineProperty(e,"append",{configurable:!0,enumerable:!0,writable:!0,value:function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];e.forEach(function(e){t.appendChild(e)})}})}),t=["pushState","replaceState","back","forward","go","scrollRestoration"],void 0===window.history?(window.history={length:0,state:{}},t.forEach(function(e){void 0===window.history[e]&&(window.history[e]=function(){})})):t.forEach(function(e){void 0===window.history[e]&&(window.history[e]=function(){})});var n=navigator.userAgent,r=window.devicePixelRatio||1,i=window.innerWidth,o=/(?:Android)/.test(n),a=/(?:Firefox)/.test(n),l=/(?:Chrome|CriOS)/.test(n),d=/(?:iPad|PlayBook)/.test(n)||o&&!/(?:Mobile)/.test(n)||a&&/(?:Tablet)/.test(n),u=/(?:iPhone)/.test(n)&&!d,s=/MicroMessenger/.test(n),c=!u&&!o,f=1<r?i<=320:i<=640,p=1<r?i<=375:i<=750,h=1<r?i<=512:i<=1024,v=1<r?i<=640:i<=1280,m=Object.freeze({__proto__:null,isAndroid:o,isFireFox:a,isChrome:l,isPad:d,isIos:u,isWechat:s,isPc:c,isSmall:f,isMiddle:p,isLarge:h,isExtraLarge:v}),y=1e4,w=16/y,_=[0,0];function g(e,t){var n;void 0===e&&(e=.5),void 0===t&&(t=.5);for(var r,i,o,a,l,d=Math.min(Math.max(350*e,20),350),u=Math.min(Math.max(40-40*t,1),40),s=[],c=0,f=0;c!==y||0!==f;)void 0,l=(r=c)+(a=(o=f)+(-d*(r-(i=y))+-u*o)*w)*w,Math.abs(a)<1&&Math.abs(l-i)<1?(_[0]=i,_[1]=0):(_[0]=l,_[1]=a),c=(n=_)[0],f=n[1],s.push(c/y);return function(e){return s[Math.ceil(e*(s.length-1))]}}var C=new Set;document.createElement("input");function x(e,t){if("string"!=typeof e)return M(e||document.createElement("div"));var n=document.createElement(e,t);return M(n)}var b={"@media-sm":"@media (min-width: 640px)","@media-md":"@media (min-width: 768px)","@media-lg":"@media (min-width: 1024px)","@media-xl":"@media (min-width: 1280px)","@media-ios":"@media (min-width: "+(u?"0px":"9999px")+")","@media-android":"@media (min-width: "+(o?"0px":"9999px")+")","@media-pc":"@media (min-width: "+(c?"0px":"9999px")+")","@media-phone":"@media (min-width: "+(c?"9999px":"0px")+")","@media-wechat":"@media (min-width: "+(s?"9999px":"0px")+")","@media-pad":"@media (min-width: "+(d?"9999px":"0px")+")"},M=function(d){if(d._DOM)return d._DOM;var a={__isChain:!0,element:d,getElement:function(e){return e(d),a},ref:function(e){return e(a),a},addEvent:function(e,t,n){return d.__events||(d.__events=new Set),d.__events.add([e,t,n]),d.addEventListener(e,t,n),a},addEventListener:function(e,t,n){return d.addEventListener(e,t,n),a},removeEventListener:function(e,t,n){return d.removeEventListener(e,t,n),a},innerText:function(e){return d.innerText=e,a},innerHTML:function(e){return d.innerHTML=e,a},textContent:function(e){return d.textContent=e,a},querySelector:function(e,t,n){var r=d.querySelector(e);return r?t(r):n&&n(),a},querySelectorAll:function(e,t){return t(d.querySelectorAll(e)),a},insertBefore:function(e,t,n){var r=d.querySelector(e);return r?d.insertBefore(t,r):n&&n(),a},insertAdjacentElement:function(e,t){return d.insertAdjacentElement(e,t),a},removeAllChildren:function(){if(d)for(var e=0;e<d.children.length;e++){var t=d.children.item(e);M(t).remove()}return d.innerHTML="",a},removeChild:function(e){for(var t=0;t<d.children.length;t++){var n=d.children.item(t);e(n,t)&&M(n).remove()}return a},remove:function(){if(a.removeAllChildren(),d.__onRemove&&d.__onRemove(d.__lastMemo,a),d.__connectStore){var e=d.__connectStore,t=e.store,n=e.onUpdate;t.unListen(n)}return d.__events&&(d.__events.forEach(function(e){d.removeEventListener.apply(d,e)}),d.__events.clear(),d.__events=null),d._DOM=null,d._state=null,d.remove(),a.element=null,a=null},append:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.forEach(function(e){if(e){var t=e.__isChain?e.element:e;if(d.appendChild(t),t.__onAppend&&t.__onAppend(t.__lastMemo,t._DOM),t.__connectStore){var n=t.__connectStore,r=n.store,i=n.onUpdate,o=n.memo;r.listen(i,o)}if(t.__onRendered){t.id||(t.id=Math.random().toString(16).slice(2));var a=0,l=function(){a++,document.getElementById(t.id)?t.__onRendered(t.__lastMemo,t._DOM):a<100&&setTimeout(l,40)};setTimeout(l,40)}}}),a},props:function(t){return Object.keys(t).forEach(function(e){d[e]=t[e]}),a},getProp:function(e,t){return t(d[e]),a},setAttribute:function(e,t){return d.setAttribute(e,t),a},removeAttribute:function(e){return d.removeAttribute(e),a},cssText:function(e){return d.style.cssText=e,a},appendCss:function(t,e){var n=""+t+e;if(!C.has(n)){var r=document.createElement("style");-1<t.indexOf("@media-")&&Object.keys(b).forEach(function(e){t=t.replace(e,b[e])}),e&&(t=t.replace(/\.\^/g,"."+e+"-")),r.textContent=t,r.type="text/css",document.head.appendChild(r),C.add(n)}return a},css:function(e,t){return t&&(e=e.replace(/\^/g,t+"-")),d.setAttribute("class",e),a},style:function(t){return Object.keys(t).forEach(function(e){d.style[e]=t[e]}),a},keyframesSpring:function(e,t,n,r){if(!C.has(e)){var i=document.createElement("style"),o=function(e,t,n,r){void 0===t&&(t=.5),void 0===n&&(n=.5);var i="";i+="0%{"+r(0)+"} ";for(var o=g(t,n),a=2;a<100;a+=1){i+=a+"%{"+r(o(a/100))+"} "}i+="100%{"+r(1)+"} ";var l="";l+="0%{"+r(1)+"} ";var d=g(t,n);for(a=2;a<100;a+=2){l+=a+"%{"+r(1-d(a/100))+"} "}return"@keyframes "+e+" {"+i+"} @keyframes "+e+"-reverse {"+(l+="100%{"+r(0)+"} ")+"}"}(e,t,n,r);i.textContent=o,i.type="text/css",document.head.appendChild(i),C.add(e)}return a},onAppend:function(e){return d.__onAppend=e,d.setAttribute("vanilly-onappend","1"),a},onRendered:function(e){return d.__onRendered=e,d.setAttribute("vanilly-onmount","1"),a},onRemove:function(e){return d.__onRemove=e,d.setAttribute("vanilly-onremove","1"),a},connectStore:function(e,t,n){return d.__connectStore={store:e,onUpdate:t,memo:n},a}};return d&&(d._DOM=a),a},E=function(){return(E=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function A(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function R(e,t){if(!e)return null;for(var n,r=/([^=?&]+)=?([^&]*)/g,i={};n=r.exec(e);){var o=A(n[1]),a=A(n[2]);null===o||null===a||o in i||(t||(a=isNaN(Number(a))?a:Number(a)),i[o]=a)}return i}function S(e,t){void 0===t&&(t="");var n,r,i=[];for(r in"string"!=typeof t&&(t="?"),e)if(Object.prototype.hasOwnProperty.call(e,r)){if((n=e[r])||null!=n&&!isNaN(n)||(n=""),r=encodeURIComponent(r),n=encodeURIComponent(n),null===r||null===n)continue;i.push(r+"="+n)}return i.length?t+i.join("&"):""}var O="block",L="block",k="absolute",P="auto",T="none";var j,D={routeManage:j=function(){function a(e,t){var n=e+t;if(f.has(n))return f.get(n);var r=e&&e.split("/"),i=t&&t.split("/");if(!i||!r)return f.set(n,!1),!1;var o=!0;return r.forEach(function(e,t){"*"!==e&&e!==i[t]&&(o=!1)}),f.set(n,o),o}function l(){if(0<window.location.hash.length){var e=window.location.hash.split("?"),t=e[0],n=e[1],r=void 0===n?"":n;return[t.replace(h,""),r]}return[window.location.pathname,window.location.search||""]}function d(e,t){for(var n=0,r=o;n<r.length;n++){(0,r[n])(e,t,s)}}function u(e,t,n){if(e!==c[c.length-1]){c.push(e);var r=E({},s[e],t);if(s[e]=r,"undefined"!=typeof window&&!n&&!v){var i=S(r);window.history.pushState(null,""+h+e,""===i?""+h+e:""+h+e+"?"+i)}d(e,t)}}function i(e,t){for(var n="number"==typeof e?e:c.length-1,r=c[n-1],i=s[r],o=0;o<c.length-n;o++)t||window.history.back(),s[r]={},c.pop();d(r,i)}var s={},c=[],f=new Map,p=new Map,h="",v=!1,o=[];if("undefined"!=typeof window){window.addEventListener("popstate",function(){if(l()[0]!==c[c.length-1]){var n=!1;if(c.forEach(function(e,t){e===l()[0]&&(n=!0)}),n)i(void 0,!0);else{var e=l(),t=e[0],r=e[1];u(t,""!==r?R(r):void 0,!0)}}else d(l()[0],void 0)})}return{checkPathMatch:function(e){var t=e+":"+c.join(",");if(p.has(t))return p.get(t);for(var n=!1,r=0,i=0;i<c.length;i++){a(e,c[i])&&(r=i,n=!0)}var o=[a(e,c[c.length-1]),n,r];return p.set(t,o),o},init:function(e,t,n){if(void 0===n&&(n="#"),v=t||!1,h=n,"undefined"!=typeof window){var r=l(),i=r[0],o=R(r[1]);"/"===i||i===e?u(e,o):(u(e),u(i,o))}},listen:function(e){o.push(e)},pop:i,push:u,replace:function(e,t){var n=e||c[c.length-1],r=E({},s[e],t);if(s[e]=r,c[s.paths.length-1]=n,"undefined"!=typeof window){var i=S(r);window.history.replaceState(null,""+h+n,""===i?""+h+n:""+h+n+"?"+i)}d(n,t)},state:s,paths:c}}(),Route:function(e){var a=e.path,l=e.component,d=e.delay,t=e.keep,u=void 0===t||t,s=e.leaveTime,c=x("div");c.setAttribute("route",a),c.style({width:"100%",height:"100%",overflow:"hidden",left:"0px",top:"0px",backgroundColor:"#fff",pointerEvents:T,display:L,position:k,zIndex:1});var f={animeTimer:null,unListen:null,isRenderChild:!1,style:{},realChild:null},p=function(){var e=j.checkPathMatch(a),t=e[0],n=e[1],r=e[2];if(t)f.realChild||(void 0===d?(f.realChild=l(),c.removeAllChildren().append(f.realChild),p()):l().then(function(e){f.realChild=e(),c.removeAllChildren().append(f.realChild),p()})),f.isRenderChild=!0,f.style={pointerEvents:P,display:O,position:"relative",zIndex:3},c.style(f.style);else{var i=u&&n,o=f.isRenderChild;void 0!==f.isRenderChild&&!0!==f.isRenderChild||(0<r&&s&&0<s?(f.style={pointerEvents:P,display:O,position:k,zIndex:O},c.style(f.style),setTimeout(function(){f.isRenderChild=i,f.style={pointerEvents:T,display:L,position:k,zIndex:1},c.style(f.style),o&&!f.isRenderChild?c.removeAllChildren():o||c.removeAllChildren().append(f.realChild)},s)):(f.isRenderChild=i,f.style={pointerEvents:T,display:L,position:k,zIndex:0<r?2:1},c.style(f.style),o&&!f.isRenderChild?c.removeAllChildren():o||c.removeAllChildren().append(f.realChild)))}};return c.onAppend(function(){f.unListen=j.listen(p)}),c.onRemove(function(){f.unListen&&f.unListen(),f.realChild=null,f.animeTimer=null}),c}},I=D.routeManage,U=D.Route;e.DOM=x,e.Route=U,e.Springer=g,e.createStore=function(e){var i={state:e,events:new Set,listen:function(e,t){return t&&(e.getMemo=t,e.lastMemo=t(i.state)),i.events.has(e)||i.events.add(e),function(){i.events.delete(e)}},unListen:function(e){i.events.delete(e)},setState:function(e){i.state=E({},i.state,e),i.update()},beforeUpdate:function(e){e&&e(i.state)},update:function(e){i.beforeUpdate(e),i.events.forEach(function(e){if(e.getMemo&&e.lastMemo){for(var t=e.getMemo(i.state),n=!1,r=0;r<e.lastMemo.length;r++){if(e.lastMemo[r]!==t[r]){n=!0;break}}n&&e(i.state)}else e(i.state)})}};return i},e.device=m,e.makeStyle=function(e){return e},e.routeManage=I,e.toDOM=M,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=index.js.map
