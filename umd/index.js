!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).vanilly={})}(this,function(e){"use strict";var t;[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach(function(e){e.hasOwnProperty("remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})}),[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach(function(e){e.hasOwnProperty("append")||Object.defineProperty(e,"append",{configurable:!0,enumerable:!0,writable:!0,value:function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];e.forEach(function(e){t.appendChild(e)})}})}),t=["pushState","replaceState","back","forward","go","scrollRestoration"],void 0===window.history?(window.history={length:0,state:{}},t.forEach(function(e){void 0===window.history[e]&&(window.history[e]=function(){})})):t.forEach(function(e){void 0===window.history[e]&&(window.history[e]=function(){})});function n(e,t){return H("string"!=typeof e?e:document.createElement(e,t))}var i=navigator.userAgent,r=window.devicePixelRatio||1,o=window.innerWidth,a=/(?:Android)/.test(i),d=/(?:Firefox)/.test(i),l=/(?:Chrome|CriOS)/.test(i),s=/(?:iPad|PlayBook)/.test(i)||a&&!/(?:Mobile)/.test(i)||d&&/(?:Tablet)/.test(i),u=/(?:iPhone)/.test(i)&&!s,c=/MicroMessenger/.test(i),p=!u&&!a,f=1<r?o<=320:o<=640,h=1<r?o<=375:o<=750,v=1<r?o<=512:o<=1024,m=1<r?o<=640:o<=1280,_=Object.freeze({__proto__:null,isAndroid:a,isFireFox:d,isChrome:l,isPad:s,isIos:u,isWechat:c,isPc:p,isSmall:f,isMiddle:h,isLarge:v,isExtraLarge:m}),y="vanilly-onupdate",w="vanilly-onappend",g="vanilly-onmount",C="vanilly-onremove",x=function(){return(x=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function b(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function E(e,t){if(!e)return null;for(var n,i=/([^=?&]+)=?([^&]*)/g,r={};n=i.exec(e);){var o=b(n[1]),a=b(n[2]);null===o||null===a||o in r||(t||(a=isNaN(Number(a))?a:Number(a)),r[o]=a)}return r}function M(e,t){void 0===t&&(t="");var n,i,r=[];for(i in"string"!=typeof t&&(t="?"),e)if(Object.prototype.hasOwnProperty.call(e,i)){if((n=e[i])||null!=n&&!isNaN(n)||(n=""),i=encodeURIComponent(i),n=encodeURIComponent(n),null===i||null===n)continue;r.push(i+"="+n)}return r.length?t+r.join("&"):""}function S(d){function l(e,t){var n=e+t;if(c.has(n))return c.get(n);var i=e&&e.split("/"),r=t&&t.split("/");if(!r||!i)return c.set(n,!1),!1;var o=!0;return i.forEach(function(e,t){"*"!==e&&e!==r[t]&&(o=!1)}),c.set(n,o),o}function a(){if(0<window.location.hash.length){var e=window.location.hash.split("?"),t=e[0],n=e[1],i=void 0===n?"":n;return[t.replace(f,""),i]}return[window.location.pathname,window.location.search||""]}function s(e,t){for(var n=0,i=r;n<i.length;n++){(0,i[n])(e,t,d.getState())}}function u(i,r,o){i!==d.getState().paths[d.getState().paths.length-1]&&(d.update(function(e){e.paths.push(i);var t=x({},e.history[i],r);if(e.history[i]=t,"undefined"!=typeof window&&!o&&!h){var n=M(t);window.history.pushState(null,""+f+i,""===n?""+f+i:""+f+i+"?"+n)}}),s(i,r))}function o(e,n){var t=d.getState(),i="number"==typeof e?e:t.paths.length-1,r=t.paths[i-1],o=t.history[r];d.update(function(e){for(var t=0;t<e.paths.length-i;t++)n||window.history.back(),e.history[r]={},e.paths.pop()}),s(r,o)}var c=new Map,p=new Map,f="",h=!1,r=[];if("undefined"!=typeof window){window.addEventListener("popstate",function(){var e=d.getState().paths;if(a()[0]!==e[e.length-1]){var n=!1;if(e.forEach(function(e,t){e===a()[0]&&(n=!0)}),n)o(void 0,!0);else{var t=a(),i=t[0],r=t[1];u(i,""!==r?E(r):void 0,!0)}}else s(a()[0],void 0)})}return{checkPathMatch:function(e){var t=d.getState().paths,n=e+":"+t.join(",");if(p.has(n))return p.get(n);for(var i=!1,r=0,o=0;o<t.length;o++){l(e,t[o])&&(r=o,i=!0)}var a=[l(e,t[t.length-1]),i,r];return p.set(n,a),a},init:function(e,t,n){if(void 0===n&&(n="#"),h=t||!1,f=n,d.update(function(e){e.paths=[],e.history=x({},e.history)}),"undefined"!=typeof window){var i=a(),r=i[0],o=E(i[1]);"/"===r||r===e?u(e,o):(u(e),u(r,o))}},listen:function(e){r.push(e)},pop:o,push:u,replace:function(i,r){var e=d.getState(),o=i||e.paths[e.paths.length-1];d.update(function(e){var t=x({},e.history[i],r);if(e.history[i]=t,e.paths[e.paths.length-1]=o,"undefined"!=typeof window){var n=M(t);window.history.replaceState(null,""+f+o,""===n?""+f+o:""+f+o+"?"+n)}}),s(o,r)}}}var R="block",A="block",O="absolute",L="auto",T="none";var P,j={__listenFns:new Set,__listenNodes:new Set,__state:{},mutationObserver:function(e){return e},middleware:{update:[],getState:[]},getState:function(){return 0<j.middleware.getState.length&&j.middleware.getState.forEach(function(e){j.__state=e(j.__state)}),j.__state},update:function(e){0<j.middleware.update.length&&j.middleware.update.forEach(function(e){j.__state=e(j.__state)});var t=e(j.__state);t&&(j.__state=t),j.__listenFns.forEach(function(e){var t=e(j.__state);t&&(j.__state=t)}),j.__listenNodes.forEach(function(e){if(e&&e.__onMemo&&e.__onUpdate){var t=e.__onMemo(j.__state);e.__lastMemo!==t&&(e.__onUpdate(t||[],e._DOM),e.__lastMemo=t)}})},listen:function(e){j.__listenFns.has(e)||j.__listenFns.add(e)}},k={routeManage:P=S(j),Route:function(e){var a=e.path,d=e.component,l=e.delay,t=e.keep,s=void 0===t||t,u=e.leaveTime,c=n("div");c.setAttribute("route",a),c.style({width:"100%",height:"100%",overflow:"hidden",left:"0px",top:"0px",backgroundColor:"#fff",pointerEvents:T,display:A,position:O,zIndex:1});var p={animeTimer:null,unListen:null,isRenderChild:!1,style:{},realChild:null},f=function(){var e=P.checkPathMatch(a),t=e[0],n=e[1],i=e[2];if(t)p.realChild||(void 0===l?(p.realChild=d(),c.innerHTML("").append(p.realChild),f()):d().then(function(e){p.realChild=e(),c.innerHTML("").append(p.realChild),f()})),p.isRenderChild=!0,p.style={pointerEvents:L,display:R,position:"relative",zIndex:3},c.style(p.style);else{var r=s&&n,o=p.isRenderChild;void 0!==p.isRenderChild&&!0!==p.isRenderChild||(0<i&&u&&0<u?(p.style={pointerEvents:L,display:R,position:O,zIndex:R},c.style(p.style),setTimeout(function(){p.isRenderChild=r,p.style={pointerEvents:T,display:A,position:O,zIndex:1},c.style(p.style),o&&!p.isRenderChild?c.clearChildren():o||c.clearChildren().append(p.realChild)},u)):(p.isRenderChild=r,p.style={pointerEvents:T,display:A,position:O,zIndex:0<i?2:1},c.style(p.style),o&&!p.isRenderChild?c.clearChildren():o||c.clearChildren().append(p.realChild)))}};return c.onAppend(function(){p.unListen=P.listen(f)}),c.onRemove(function(){p.unListen&&p.unListen(),p.realChild=null,p.animeTimer=null}),c}},N=k.Route,I=k.routeManage,D=1e4,U=16/D,F=[0,0];function z(e,t){var n;void 0===e&&(e=.5),void 0===t&&(t=.5);for(var i,r,o,a,d,l=Math.min(Math.max(350*e,20),350),s=Math.min(Math.max(40-40*t,1),40),u=[],c=0,p=0;c!==D||0!==p;)void 0,d=(i=c)+(a=(o=p)+(-l*(i-(r=D))+-s*o)*U)*U,Math.abs(a)<1&&Math.abs(d-r)<1?(F[0]=r,F[1]=0):(F[0]=d,F[1]=a),c=(n=F)[0],p=n[1],u.push(c/D);return function(e){return u[Math.ceil(e*(u.length-1))]}}var q=new Set;document.createElement("input");var B={"@media-sm":"@media (min-width: 640px)","@media-md":"@media (min-width: 768px)","@media-lg":"@media (min-width: 1024px)","@media-xl":"@media (min-width: 1280px)","@media-ios":"@media (min-width: "+(u?"0px":"9999px")+")","@media-android":"@media (min-width: "+(a?"0px":"9999px")+")","@media-pc":"@media (min-width: "+(p?"0px":"9999px")+")","@media-phone":"@media (min-width: "+(p?"9999px":"0px")+")","@media-wechat":"@media (min-width: "+(c?"9999px":"0px")+")","@media-pad":"@media (min-width: "+(s?"9999px":"0px")+")"};function H(r){var a={__isChain:!0,element:r,getElement:function(e){return e(r),a},ref:function(e){return e(a),a},addEvent:function(e,t,n){return r.__events||(r.__events=new Set),r.__events.add([e,t,n]),r.addEventListener(e,t,n),a},addEventListener:function(e,t,n){return r.addEventListener(e,t,n),a},removeEventListener:function(e,t,n){return r.removeEventListener(e,t,n),a},innerText:function(e){return r.innerText=e,a},innerHTML:function(e){return r.innerHTML=e,a},textContent:function(e){return r.textContent=e,a},querySelector:function(e,t,n){var i=r.querySelector(e);return i?t(i):n&&n(),a},querySelectorAll:function(e,t){return t(r.querySelectorAll(e)),a},insertBefore:function(e,t,n){var i=r.querySelector(e);return i?r.insertBefore(t,i):n&&n(),a},insertAdjacentElement:function(e,t){return r.insertAdjacentElement(e,t),a},clearChildren:function(){for(var e=0;e<r.children.length;e++){H(r.children.item(e)).remove()}return a},removeChild:function(e){for(var t=0;t<r.children.length;t++){var n=r.children.item(t);e(n,t)&&H(n).remove()}return a},remove:function(){return a.clearChildren(),r.__onRemove&&(r.__onRemove(r.__lastMemo,a),j.__listenNodes.delete(r)),r.__events&&(r.__events.forEach(function(e){r.removeEventListener.apply(r,e)}),r.__events.clear(),r.__events=null),r._DOM=null,r._state=null,r.remove(),a.element=null,a=null},append:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.forEach(function(e){if(e){var t=e.__isChain?e.element:e;if(t.__onUpdate&&(j.__listenNodes.has(t)||j.__listenNodes.add(t)),r.appendChild(t),t.__onAppend&&t.__onAppend(t.__lastMemo,a),t.__onRendered){t.id||(t.id=Math.random().toString(16).slice(2));var n=0,i=function(){n++,document.getElementById(t.id)?t.__onRendered(t.__lastMemo,a):n<100&&setTimeout(i,40)};setTimeout(i,40)}}}),a},props:function(t){return Object.keys(t).forEach(function(e){r[e]=t[e]}),a},getProp:function(e,t){return t(r[e]),a},setAttribute:function(e,t){return r.setAttribute(e,t),a},removeAttribute:function(e){return r.removeAttribute(e),a},cssText:function(e){return r.style.cssText=e,a},appendCss:function(t,e){var n=""+t+e;if(!q.has(n)){var i=document.createElement("style");-1<t.indexOf("@media-")&&Object.keys(B).forEach(function(e){t=t.replace(e,B[e])}),e&&(t=t.replace(/\.\^/g,"."+e+"-")),i.textContent=t,document.head.appendChild(i),q.add(n)}return a},css:function(e,t){return t&&(e=e.replace(/\^/g,t+"-")),r.setAttribute("class",e),a},style:function(t){return Object.keys(t).forEach(function(e){r.style[e]=t[e]}),a},keyframesSpring:function(e,t,n,i){if(!q.has(e)){var r=document.createElement("style"),o=function(e,t,n,i){void 0===t&&(t=.5),void 0===n&&(n=.5);var r="";r+="0%{"+i(0)+"} ";for(var o=z(t,n),a=2;a<100;a+=1){r+=a+"%{"+i(o(a/100))+"} "}r+="100%{"+i(1)+"} ";var d="";d+="0%{"+i(1)+"} ";var l=z(t,n);for(a=2;a<100;a+=2){d+=a+"%{"+i(1-l(a/100))+"} "}return"@keyframes "+e+" {"+r+"} @keyframes "+e+"-reverse {"+(d+="100%{"+i(0)+"} ")+"}"}(e,t,n,i);r.textContent=o,document.head.appendChild(r),q.add(e)}return a},onUpdate:function(e,t){return r.__onMemo=e,r.__onUpdate=t,r.setAttribute(y,"1"),a},onAppend:function(e){return r.__onAppend=e,r.setAttribute(w,"1"),a},onRendered:function(e){return r.__onRendered=e,r.setAttribute(g,"1"),a},onRemove:function(e){return r.__onRemove=e,r.setAttribute(C,"1"),a}};return r&&(r._DOM=a),a}e.DOM=n,e.Route=N,e.Springer=z,e.device=_,e.routeManage=I,e.store=j,e.toDOM=H,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=index.js.map
