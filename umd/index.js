!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).vanilly={})}(this,function(e){"use strict";void 0===window.history&&(window.history={}),void 0===window.history.pushState&&(window.history.pushState=function(){window.history.length+=1}),void 0===window.history.replaceState&&(window.history.replaceState=function(){}),void 0===window.history.back&&(window.history.back=function(){window.history.length-=1}),void 0===window.history.forward&&(window.history.forward=function(){}),void 0===window.history.go&&(window.history.go=function(){}),void 0===window.history.length&&(window.history.length=0),void 0===window.history.state&&(window.history.state={}),void 0===window.history.scrollRestoration&&(window.history.scrollRestoration=function(){}),[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach(function(e){e.hasOwnProperty("remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})}),[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach(function(e){e.hasOwnProperty("append")||Object.defineProperty(e,"append",{configurable:!0,enumerable:!0,writable:!0,value:function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];e.forEach(function(e){t.appendChild(e)})}})});var n="vanilly-onupdate",t="vanilly-onappend",i="vanilly-onmount",r="vanilly-onremove",v=function(){return(v=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function d(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function m(e,t){if(!e)return null;for(var n,i=/([^=?&]+)=?([^&]*)/g,o={};n=i.exec(e);){var r=d(n[1]),a=d(n[2]);null===r||null===a||r in o||(t||(a=isNaN(Number(a))?a:Number(a)),o[r]=a)}return o}function y(e,t){void 0===t&&(t="");var n,i,o=[];for(i in"string"!=typeof t&&(t="?"),e)if(Object.prototype.hasOwnProperty.call(e,i)){if((n=e[i])||null!=n&&!isNaN(n)||(n=""),i=encodeURIComponent(i),n=encodeURIComponent(n),null===i||null===n)continue;o.push(i+"="+n)}return o.length?t+o.join("&"):""}function o(d){function s(e,t){var n=e+t;if(c.has(n))return c.get(n);var i=e&&e.split("/"),o=t&&t.split("/");if(!o||!i)return c.set(n,!1),!1;var r=!0;return i.forEach(function(e,t){"*"!==e&&e!==o[t]&&(r=!1)}),c.set(n,r),r}function a(){if(0<window.location.hash.length){var e=window.location.hash.split("?"),t=e[0],n=e[1],i=void 0===n?"":n;return[t.replace(p,""),i]}return[window.location.pathname,window.location.search||""]}function l(e,t){for(var n=0,i=o;n<i.length;n++){(0,i[n])(e,t,d.getState())}}function u(i,o,r){i!==d.getState().paths[d.getState().paths.length-1]&&(d.update(function(e){e.paths.push(i);var t=v({},e.history[i],o);if(e.history[i]=t,"undefined"!=typeof window&&!r&&!f){var n=y(t);window.history.pushState(null,""+p+i,""===n?""+p+i:""+p+i+"?"+n)}}),l(i,o))}function r(e,n){var t=d.getState(),i="number"==typeof e?e:t.paths.length-1,o=t.paths[i-1],r=t.history[o];d.update(function(e){for(var t=0;t<e.paths.length-i;t++)n||window.history.back(),e.history[o]={},e.paths.pop()}),l(o,r)}var c=new Map,h=new Map,p="",f=!1,o=[];if("undefined"!=typeof window){window.addEventListener("popstate",function(){var e=d.getState().paths;if(a()[0]!==e[e.length-1]){var n=!1;if(e.forEach(function(e,t){e===a()[0]&&(n=!0)}),n)r(void 0,!0);else{var t=a(),i=t[0],o=t[1];u(i,""!==o?m(o):void 0,!0)}}else l(a()[0],void 0)})}return{checkPathMatch:function(e){var t=d.getState().paths,n=e+":"+t.join(",");if(h.has(n))return h.get(n);for(var i=!1,o=0,r=0;r<t.length;r++){s(e,t[r])&&(o=r,i=!0)}var a=[s(e,t[t.length-1]),i,o];return h.set(n,a),a},init:function(e,t,n){if(void 0===n&&(n="#"),f=t||!1,p=n,d.update(function(e){e.paths=[],e.history=v({},e.history)}),"undefined"!=typeof window){var i=a(),o=i[0],r=m(i[1]);"/"===o||o===e?u(e,r):(u(e),u(o,r))}},listen:function(e){o.push(e)},pop:r,push:u,replace:function(i,o){var e=d.getState(),r=i||e.paths[e.paths.length-1];d.update(function(e){var t=v({},e.history[i],o);if(e.history[i]=t,e.paths[e.paths.length-1]=r,"undefined"!=typeof window){var n=y(t);window.history.replaceState(null,""+p+r,""===n?""+p+r:""+p+r+"?"+n)}}),l(r,o)}}}var f="block",w="block",_="absolute",g="auto",b="none";var C,s={__listenFns:new Set,__listenNodes:new Set,__state:{},mutationObserver:function(e){return e},middleware:{update:[],getState:[]},getState:function(){return 0<s.middleware.getState.length&&s.middleware.getState.forEach(function(e){s.__state=e(s.__state)}),s.__state},update:function(e){0<s.middleware.update.length&&s.middleware.update.forEach(function(e){s.__state=e(s.__state)});var t=e(s.__state);t&&(s.__state=t),s.__listenFns.forEach(function(e){var t=e(s.__state);t&&(s.__state=t)}),s.__listenNodes.forEach(function(e){if(e&&e.__onMemo&&e.__onUpdate){var t=e.__onMemo(s.__state);e.__lastMemo!==t&&(e.__onUpdate(t||[],e),e.__lastMemo=t)}})},listen:function(e){s.__listenFns.has(e)||s.__listenFns.add(e)}},a={routeManage:C=o(s),Route:function(e){var a=e.path,d=e.component,s=e.delay,t=e.keep,l=void 0===t||t,u=e.leaveTime,c=j("div");c.setAttribute("route",a),c.style({width:"100%",height:"100%",overflow:"hidden",left:"0px",top:"0px",backgroundColor:"#fff",pointerEvents:b,display:w,position:_,zIndex:1});var h={animeTimer:null,unListen:null,isRenderChild:!1,style:{},realChild:null},p=function(){var e=C.checkPathMatch(a),t=e[0],n=e[1],i=e[2];if(t)h.realChild||(void 0===s?(h.realChild=d(),c.innerHTML("").append(h.realChild),p()):d().then(function(e){h.realChild=e(),c.innerHTML("").append(h.realChild),p()})),h.isRenderChild=!0,h.style={pointerEvents:g,display:f,position:"relative",zIndex:3},c.style(h.style);else{var o=l&&n,r=h.isRenderChild;void 0!==h.isRenderChild&&!0!==h.isRenderChild||(0<i&&u&&0<u?(h.style={pointerEvents:g,display:f,position:_,zIndex:f},c.style(h.style),setTimeout(function(){h.isRenderChild=o,h.style={pointerEvents:b,display:w,position:_,zIndex:1},c.style(h.style),r&&!h.isRenderChild?c.innerHTML(""):r||c.innerHTML("").append(h.realChild)},u)):(h.isRenderChild=o,h.style={pointerEvents:b,display:w,position:_,zIndex:0<i?2:1},c.style(h.style),r&&!h.isRenderChild?c.innerHTML(""):r||c.innerHTML("").append(h.realChild)))}};return c.onAppend(function(){h.unListen=C.listen(p)}),c.onRemove(function(){h.unListen&&h.unListen(),h.realChild=null,h.animeTimer=null}),c}},l=a.Route,u=a.routeManage,c=navigator.userAgent,h=/(?:Android)/.test(c),p=/(?:Firefox)/.test(c),x=/(?:Chrome|CriOS)/.test(c),M=/(?:iPad|PlayBook)/.test(c)||h&&!/(?:Mobile)/.test(c)||p&&/(?:Tablet)/.test(c),E=/(?:iPhone)/.test(c)&&!M,R=/MicroMessenger/.test(c),S=!E&&!h,T=1e4,A=16/T,L=[0,0];function O(e,t){var n;void 0===e&&(e=.5),void 0===t&&(t=.5);for(var i,o,r,a,d,s=Math.min(Math.max(350*e,20),350),l=Math.min(Math.max(40-40*t,1),40),u=[],c=0,h=0;c!==T||0!==h;)void 0,d=(i=c)+(a=(r=h)+(-s*(i-(o=T))+-l*r)*A)*A,Math.abs(a)<1&&Math.abs(d-o)<1?(L[0]=o,L[1]=0):(L[0]=d,L[1]=a),c=(n=L)[0],h=n[1],u.push(c/T);return function(e){return u[Math.ceil(e*(u.length-1))]}}var k=new Set,P={"@media-sm":"@media (min-width: 640px)","@media-md":"@media (min-width: 768px)","@media-lg":"@media (min-width: 1024px)","@media-xl":"@media (min-width: 1280px)","@media-ios":"@media (min-width: "+(E?"0px":"9999px")+")","@media-android":"@media (min-width: "+(h?"0px":"9999px")+")","@media-pc":"@media (min-width: "+(S?"0px":"9999px")+")","@media-phone":"@media (min-width: "+(S?"9999px":"0px")+")","@media-wechat":"@media (min-width: "+(R?"9999px":"0px")+")","@media-pad":"@media (min-width: "+(M?"9999px":"0px")+")"};function N(o){var a={__isChain:!0,element:o,ref:function(e){return e(a),a},addEventListener:function(e,t,n){return o.addEventListener(e,t,n),a},removeEventListener:function(e,t,n){return o.removeEventListener(e,t,n),a},innerText:function(e){return o.innerText=e,a},innerHTML:function(e){return o.innerHTML=e,a},textContent:function(e){return o.textContent=e,a},children:function(e){for(var t=[],n=0;n<o.children.length;n++)t.push(o.children.item(n));return e(t),a},clearChildren:function(){for(var e=0;e<o.children.length;e++){N(o.children.item(e)).remove()}return a},removeChild:function(e){for(var t=0;t<o.children.length;t++){var n=o.children.item(t);e(n,t)&&N(n).remove()}return a},remove:function(){return a.clearChildren(),o.__onRemove&&(o.__onRemove(o.__lastMemo,o),s.__listenNodes.delete(o)),o.remove(),a},append:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.forEach(function(e){if(e){var t=e.__isChain?e.element:e;if(t.__onUpdate&&(s.__listenNodes.has(t)||s.__listenNodes.add(t)),o.appendChild(t),t.__onAppend&&t.__onAppend(t.__lastMemo,t),t.__onRendered){t.id||(t.id=Math.random().toString(16).slice(2));var n=0,i=function(){n++,document.getElementById(t.id)?t.__onRendered(t.__lastMemo,t):n<100&&setTimeout(i,40)};setTimeout(i,40)}}}),a},setProps:function(t){return Object.keys(t).forEach(function(e){o[e]=t[e]}),a},setAttribute:function(e,t){return o.setAttribute(e,t),a},removeAttribute:function(e){return o.removeAttribute(e),a},cssText:function(e){return o.style.cssText=e,a},css:function(t,e){var n=""+t+e;if(!k.has(n)){var i=document.createElement("style");-1<t.indexOf("@media-")&&Object.keys(P).forEach(function(e){t=t.replace(e,P[e])}),e&&(t=t.replace(/\.\^/g,"."+e+"-")),i.textContent=t,document.head.appendChild(i),k.add(n)}return a},class:function(e,t){return t&&(e=e.replace(/\^/g,t+"-")),o.setAttribute("class",e),a},updateClass:function(e){if("string"==typeof e)o.setAttribute("class",(o.className||"")+e);else{var t=e(o.className||"");o.setAttribute("class",t)}return a},style:function(t){return Object.keys(t).forEach(function(e){o.style[e]=t[e]}),a},keyframesSpring:function(e,t,n,i){if(!k.has(e)){var o=document.createElement("style"),r=function(e,t,n,i){void 0===t&&(t=.5),void 0===n&&(n=.5);var o="";o+="0%{"+i(0)+"} ";for(var r=O(t,n),a=2;a<100;a+=1){o+=a+"%{"+i(r(a/100))+"} "}o+="100%{"+i(1)+"} ";var d="";d+="0%{"+i(1)+"} ";var s=O(t,n);for(a=2;a<100;a+=2){d+=a+"%{"+i(1-s(a/100))+"} "}return"@keyframes "+e+" {"+o+"} @keyframes "+e+"-reverse {"+(d+="100%{"+i(0)+"} ")+"}"}(e,t,n,i);o.textContent=r,document.head.appendChild(o),k.add(e)}return a},onUpdate:function(e,t){return o.__onMemo=e,o.__onUpdate=t,o.setAttribute(n,"1"),a},onAppend:function(e){return o.__onAppend=e,o.setAttribute(t,"1"),a},onRendered:function(e){return o.__onRendered=e,o.setAttribute(i,"1"),a},onRemove:function(e){return o.__onRemove=e,o.setAttribute(r,"1"),a}};return a}var j=function(e,t){return N("string"!=typeof e?e||document.createElement("div"):document.createElement(e,t))};e.DOM=j,e.Route=l,e.Springer=O,e.isAndroid=h,e.isChrome=x,e.isFireFox=p,e.isIos=E,e.isPad=M,e.isPc=S,e.isWechat=R,e.routeManage=u,e.store=s,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=index.js.map
